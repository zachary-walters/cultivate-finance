<!DOCTYPE html>
<html lang="en">

<head>
  <title>Analyze 401k</title>
  <script type="text/javascript" src="/assets/wasm_exec.js"></script>
</head>

<body>
  <div class="container">
    {{template "inputform" .}}
  </div>
  <div class="container"></div>
    {{template "calculations" .}}
  </div>
</body>

<script type="module"> 
import { calculate, calculateAll } from "/assets/js/401k_calculations_module.js";
import { get401kCalculatorInput } from "/assets/js/input_module.js";

function isDollarValue(str) {
  return "$" + str;
}

function isPercentValue(str, convert) {
  str = convert ? parseFloat(str).toFixed(4) * 100 : str;

  return str + "%";
}

let all = await calculateAll(get401kCalculatorInput());
console.log(all);
document.getElementById("standard-deduction").innerHTML = isDollarValue(all.default.STANDARD_DEDUCTION);
document.getElementById("income-after-standard-deduction").innerHTML = isDollarValue(all.default.INCOME_AFTER_STANDARD_DEDUCTION);
document.getElementById("equivalent-roth-contributions").innerHTML = isDollarValue(all.default.EQUIVALENT_ROTH_CONTRIBUTIONS);
document.getElementById("income-after-standard-deduction-and-contributions").innerHTML = isDollarValue(all.default.INCOME_AFTER_STANDARD_DEDUCTION_AND_CONTRIBUTIONS);
document.getElementById("annual-growth-less-inflation").innerHTML = isPercentValue(all.default.ANNUAL_GROWTH_LESS_INFLATION);
document.getElementById("annual-tax-savings-with-contributions").innerHTML = isDollarValue(all.default.ANNUAL_TAX_SAVINGS_WITH_CONTRIBUTION);
document.getElementById("tax-rate-of-savings").innerHTML = isPercentValue(all.default.TAX_RATE_OF_SAVINGS, true);
document.getElementById("net-distribution-after-taxes").innerHTML = isDollarValue(all.retirement.NET_DISTRIBUTION_AFTER_TAXES);
document.getElementById("total-taxes-owed-after-standard-deduction").innerHTML = isDollarValue(all.retirement.TOTAL_TAXES_OWED_AFTER_STANDARD_DEDUCTION);
document.getElementById("standard-deduction-retirement").innerHTML = isDollarValue(all.retirement.STANDARD_DEDUCTION);
document.getElementById("income-after-standard-deduction-retirement").innerHTML = isDollarValue(all.retirement.INCOME_AFTER_STANDARD_DEDUCTION);
document.getElementById("effective-tax-rate-on-gross").innerHTML = isPercentValue(all.retirement.EFFECTIVE_TAX_RATE_ON_GROSS, true);

document.getElementById('401k-form-submit').onclick=async() => {
  let all = await calculateAll(get401kCalculatorInput())
  document.getElementById("standard-deduction").innerHTML = isDollarValue(all.default.STANDARD_DEDUCTION);
  document.getElementById("income-after-standard-deduction").innerHTML = isDollarValue(all.default.INCOME_AFTER_STANDARD_DEDUCTION);
  document.getElementById("equivalent-roth-contributions").innerHTML = isDollarValue(all.default.EQUIVALENT_ROTH_CONTRIBUTIONS);
  document.getElementById("income-after-standard-deduction-and-contributions").innerHTML = isDollarValue(all.default.INCOME_AFTER_STANDARD_DEDUCTION_AND_CONTRIBUTIONS);
  document.getElementById("annual-growth-less-inflation").innerHTML = isPercentValue(all.default.ANNUAL_GROWTH_LESS_INFLATION);
  document.getElementById("annual-tax-savings-with-contributions").innerHTML = isDollarValue(all.default.ANNUAL_TAX_SAVINGS_WITH_CONTRIBUTION);
  document.getElementById("tax-rate-of-savings").innerHTML = isPercentValue(all.default.TAX_RATE_OF_SAVINGS, true);
  document.getElementById("net-distribution-after-taxes").innerHTML = isDollarValue(all.retirement.NET_DISTRIBUTION_AFTER_TAXES);
  document.getElementById("total-taxes-owed-after-standard-deduction").innerHTML = isDollarValue(all.retirement.TOTAL_TAXES_OWED_AFTER_STANDARD_DEDUCTION);
  document.getElementById("standard-deduction-retirement").innerHTML = isDollarValue(all.retirement.STANDARD_DEDUCTION);
  document.getElementById("income-after-standard-deduction-retirement").innerHTML = isDollarValue(all.retirement.INCOME_AFTER_STANDARD_DEDUCTION);
  document.getElementById("effective-tax-rate-on-gross").innerHTML = isPercentValue(all.retirement.EFFECTIVE_TAX_RATE_ON_GROSS, true);
}

</script>

<style>
  body {
    display:flex;
    flex-direction: column;
    row-gap: 1rem; 
  }
</style>

</html>

