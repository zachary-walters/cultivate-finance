{{define "inputform"}}
  <div class="form-content">
    <div class="current-input">
      <div class="form-input">
        <label for="current-age" class="input-label">Current Age</label>
        <input class="401k-calculator-input" type="number" id="current-age" name="current-age" value={{.input.CurrentAge}} />
      </div>
      <div class="form-input">
        <label for="current-filing-status" class="input-label">Current Filing Status</label>
        <select class="401k-calculator-input" id="current-filing-status" name="current-filing-status" value="{{.input.CurrentFilingStatus}}">
          <option value="single">Single</option>
          <option value="married-joint">Married Joint</option>
          <option value="married-seperate">Married Seperate</option>
          <option value="head-of-household">Head of Household</option>
        </select>
      </div>
      <div class="form-input">
        <label for="current-annual-income" class="input-label">Current Annual Income</label>
        <input class="401k-calculator-input" type="number" id="current-annual-income" name="current-annual-income" value={{.input.CurrentAnnualIncome}} />
      </div>
      <div class="form-input">
        <label for="annual-contributions-pre-tax" class="input-label">Annual Contributions Pretax</label>
        <input class="401k-calculator-input" type="number" id="annual-contributions-pre-tax" name="annual-contributions-pre-tax" value={{.input.AnnualContributionsPreTax}} />
      </div>
      <div class="form-input">
        <label for="annual-investment-growth" class="input-label">Annual Investment Growth (percent)</label>
        <input class="401k-calculator-input" type="number" id="annual-investment-growth" name="annual-investment-growth" value={{.input.AnnualInvestmentGrowth}} />
      </div>
    </div>

    <div class="retirement-input">
      <div class="form-input">
        <label for="retirement-age" class="input-label">Retirement Age</label>
        <input class="401k-calculator-input" type="number" id="retirement-age" name="retirement-age" value={{.input.RetirementAge}} />
      </div>
      <div class="form-input">
        <label for="retirement-filing-status" class="input-label">Retirement Filing Status</label>
        <select class="401k-calculator-input" id="retirement-filing-status" name="retirement-filing-status" value={{.input.RetirementFilingStatus}}>
          <option value="single">Single</option>
          <option value="married-joint">Married Joint</option>
          <option value="married-seperate">Married Seperate</option>
          <option value="head-of-household">Head of Household</option>
        </select>
      </div>
      <div class="form-input">
        <label for="yearly-withdrawals" class="input-label">Annual Withdrawal (today's dollars)</label>
        <input class="401k-calculator-input" type="number" id="yearly-withdrawal" name="yearly-withdrawal" value={{.input.YearlyWithdrawal}} />
      </div>
    </div>
    <div class="extra-retirement-input">
      <div class="form-input">
        <label for="work-income" class="input-label">Work Income</label>
        <input class="401k-calculator-input" type="number" id="work-income" name="work-income" value={{.input.WorkIncome}} />
      </div>
      <div class="form-input">
        <label for="qualified-dividends" class="input-label">Qualified Dividends</label>
        <input class="401k-calculator-input" type="number" id="qualified-dividends" name="qualified-dividends" value={{.input.QualifiedDividends}} />
      </div>
      <div class="form-input">
        <label for="other-long-term-capital-gains" class="input-label">Other Long Term Capital Gains</label>
        <input class="401k-calculator-input" type="number" id="other-long-term-capital-gains" name="other-long-term-capital-gains" value={{.input.OtherLongTermCapitalGains}} />
      </div>
      <div class="form-input">
        <label for="pension-income" class="input-label">Pension Income</label>
        <input class="401k-calculator-input" type="number" id="pension-income" name="pension-income" value={{.input.PensionIncome}} />
      </div>
      <div class="form-input">
        <label for="rental-net-income" class="input-label">Rental Net Income</label>
        <input class="401k-calculator-input" type="number" id="rental-net-income" name="rental-net-income" value={{.input.RentalNetIncome}} />
      </div>
      <div class="form-input">
        <label for="annuity-income" class="input-label">Annuity Income</label>
        <input class="401k-calculator-input" type="number" id="annuity-income" name="annuity-income" value={{.input.AnnuityIncome}} />
      </div>
      <div class="form-input">
        <label for="social-security" class="input-label">Social Security</label>
        <input class="401k-calculator-input" type="number" id="social-security" name="social-security" value={{.input.SocialSecurity}} />
      </div>
      <div class="form-input">
        <label for="other-taxable-income" class="input-label">Other Taxable Income</label>
        <input class="401k-calculator-input" type="number" id="other-taxable-income" name="other-taxable-income" value={{.input.OtherTaxableIncome}} />
      </div>
    </div>
  </div>

<script type="module">
import { calculate, calculateAll, isDollarValue, isPercentValue } from "/assets/js/401k_calculations_module.js";
import { get401kCalculatorInput } from "/assets/js/input_module.js";
import { generateCharts } from "/assets/js/chart_module.js";

async function recalculate() {
  let all = await calculateAll(get401kCalculatorInput());
  document.getElementById("annual-growth-less-inflation").innerHTML = isPercentValue(all.traditional.ANNUAL_GROWTH_LESS_INFLATION);
  document.getElementById("annual-tax-savings-with-contributions").innerHTML = isDollarValue(all.traditional.ANNUAL_TAX_SAVINGS_WITH_CONTRIBUTION);
  document.getElementById("effective-tax-rate-on-gross").innerHTML = isPercentValue(all.traditional_retirement.EFFECTIVE_TAX_RATE_ON_GROSS, true);
  document.getElementById("equivalent-roth-contributions").innerHTML = isDollarValue(all.traditional.EQUIVALENT_ROTH_CONTRIBUTIONS);
  document.getElementById("income-after-standard-deduction").innerHTML = isDollarValue(all.traditional.INCOME_AFTER_STANDARD_DEDUCTION);
  document.getElementById("income-after-standard-deduction-and-contributions").innerHTML = isDollarValue(all.traditional.INCOME_AFTER_STANDARD_DEDUCTION_AND_CONTRIBUTIONS);
  document.getElementById("income-after-standard-deduction-retirement").innerHTML = isDollarValue(all.traditional_retirement.INCOME_AFTER_STANDARD_DEDUCTION);
  document.getElementById("net-distribution-after-taxes").innerHTML = isDollarValue(all.traditional_retirement.NET_DISTRIBUTION_AFTER_TAXES);
  document.getElementById("standard-deduction").innerHTML = isDollarValue(all.traditional.STANDARD_DEDUCTION);
  document.getElementById("standard-deduction-retirement").innerHTML = isDollarValue(all.traditional_retirement.STANDARD_DEDUCTION);
  document.getElementById("tax-rate-of-savings").innerHTML = isPercentValue(all.traditional.TAX_RATE_OF_SAVINGS, true);
  document.getElementById("total-taxes-owed-after-standard-deduction").innerHTML = isDollarValue(all.traditional_retirement.TOTAL_TAXES_OWED_AFTER_STANDARD_DEDUCTION);

  generateCharts(all);
}

let inputs = document.getElementsByClassName("401k-calculator-input");
for (var i = 0; i < inputs.length; i++) {
  inputs[i].oninput = () => {
    setTimeout(() => {
      recalculate()
    }, 10);
  }
}
</script>
<style>
  /* Chrome, Safari, Edge, Opera */
  input::-webkit-outer-spin-button,
  input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  /* Firefox */
  input[type=number] {
    -moz-appearance: textfield;
  }

  input {
    width: 9rem;
  }

  .input-label {
    display: inline-block;
    width: 250px;
    text-align: left;
  }

  .form-content {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    row-gap: 1rem; 
  }

  .current-input, .retirement-input, .extra-retirement-input {
    display:flex;
    flex-direction: column;
    row-gap: 2px;
  }

  .form-input {
    display: flex;
  }
</style>
{{end}}